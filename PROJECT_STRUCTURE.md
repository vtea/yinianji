# é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**ä¸€å¹´çº§å­¦ä¹ æœ¬** - ä¸€ä¸ªä¸“ä¸ºä¸€å¹´çº§å­¦ç”Ÿè®¾è®¡çš„å¤šåŠŸèƒ½å­¦ä¹ å¹³å°ï¼Œé‡‡ç”¨ Duolingo é£æ ¼ç•Œé¢ï¼Œæ”¯æŒè¯­æ–‡ã€è‹±è¯­ã€æ•°å­¦ç­‰å¤šä¸ªå­¦ä¹ æ¨¡å—ï¼Œå¹¶é›†æˆ AI è¾…å¯¼åŠŸèƒ½ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Node.js + Express
- **æ•°æ®åº“**: SQLite3
- **å‰ç«¯**: åŸç”Ÿ HTML/CSS/JavaScriptï¼ˆæ— æ¡†æ¶ä¾èµ–ï¼‰
- **éƒ¨ç½²**: Docker + Nginx
- **å®‰å…¨**: bcrypt å¯†ç åŠ å¯†ã€AES-256-GCM API Key åŠ å¯†

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
yinianji-1/
â”œâ”€â”€ server.js                 # åç«¯æœåŠ¡å™¨ä¸»æ–‡ä»¶
â”œâ”€â”€ package.json              # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ Dockerfile                # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml        # Docker Compose é…ç½®
â”œâ”€â”€ nginx.conf                # Nginx é…ç½®æ–‡ä»¶
â”œâ”€â”€ nginx-docker.conf         # Docker ç¯å¢ƒ Nginx é…ç½®
â”œâ”€â”€ deploy.sh                 # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docker-deploy-complete.sh # Docker å®Œæ•´éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ .ai_key_secret            # AI Key åŠ å¯†å¯†é’¥ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ words.db                  # SQLite æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ public/                   # å‰ç«¯é™æ€æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ index.html           # ä¸»å…¥å£é¡µé¢ï¼ˆç™»å½•/æ³¨å†Œ/å¯¼èˆªï¼‰
â”‚   â”œâ”€â”€ chinese.html         # è¯­æ–‡æ¨¡å— - ç”Ÿå­—å­¦ä¹ 
â”‚   â”œâ”€â”€ pinyin.html          # è¯­æ–‡æ¨¡å— - å£°æ¯éŸµæ¯å­¦ä¹ 
â”‚   â”œâ”€â”€ english.html          # è‹±è¯­æ¨¡å— - è‹±è¯­è¯¾æ–‡å­¦ä¹ 
â”‚   â”œâ”€â”€ vocabulary.html       # è‹±è¯­æ¨¡å— - å•è¯æœ¬
â”‚   â”œâ”€â”€ ai-tutor.html         # AI è¾…å¯¼æ¨¡å—
â”‚   â””â”€â”€ math.html             # æ•°å­¦æ¨¡å—ï¼ˆå¼€å‘ä¸­ï¼‰
â””â”€â”€ DEPLOY.md                 # éƒ¨ç½²æŒ‡å—æ–‡æ¡£
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ** (`index.html`)

#### åŠŸèƒ½ç‰¹æ€§
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- âœ… å¯†ç ä¿®æ”¹
- âœ… ä¼šè¯æŒä¹…åŒ–ï¼ˆlocalStorageï¼‰
- âœ… å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptï¼‰
- âœ… ç”¨æˆ·èœå•å’Œè´¦æˆ·ç®¡ç†

#### ä¸»è¦ç»„ä»¶
- ç™»å½•/æ³¨å†Œé¢æ¿ï¼ˆå¯åˆ‡æ¢ï¼‰
- ç”¨æˆ·èœå•ï¼ˆè´¦æˆ·ã€è®¾ç½®ã€é€€å‡ºï¼‰
- å¯¼èˆªæ å’Œç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º

---

### 2. **è¯­æ–‡æ¨¡å—**

#### 2.1 ç”Ÿå­—å­¦ä¹  (`chinese.html`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… ç”Ÿå­—å¡ç‰‡å±•ç¤ºï¼ˆç±³å­—æ ¼æ ·å¼ï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆæ‹¼éŸ³ï¼ˆä½¿ç”¨ `pinyin` åº“ï¼‰
- âœ… æœ—è¯»åŠŸèƒ½ï¼ˆWeb Speech APIï¼‰
- âœ… æœ—è¯»æ¬¡æ•°ç»Ÿè®¡
- âœ… åˆ é™¤ç”Ÿå­—ï¼ˆä¿ç•™åˆ é™¤å†å²ï¼‰
- âœ… ç”Ÿå­—ç»Ÿè®¡ï¼ˆä¸è®¤è¯†/å·²è®¤è¯†æ•°é‡ï¼‰
- âœ… å“åº”å¼å¸ƒå±€ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰

**æ•°æ®æµç¨‹**:
1. ç”¨æˆ·æ·»åŠ ç”Ÿå­— â†’ `POST /api/words`
2. åç«¯è‡ªåŠ¨ç”Ÿæˆæ‹¼éŸ³å¹¶ä¿å­˜
3. å‰ç«¯å±•ç¤ºç”Ÿå­—å¡ç‰‡
4. ç‚¹å‡»å¡ç‰‡æœ—è¯» â†’ `POST /api/speak` æ›´æ–°è®¡æ•°
5. åˆ é™¤ç”Ÿå­— â†’ `POST /api/delete`ï¼ˆç§»è‡³åˆ é™¤è®°å½•è¡¨ï¼‰

#### 2.2 å£°æ¯éŸµæ¯å­¦ä¹  (`pinyin.html`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… 23 ä¸ªå£°æ¯å­¦ä¹ 
- âœ… 39 ä¸ªéŸµæ¯å­¦ä¹ 
- âœ… ç‚¹å‡»æœ—è¯»ï¼ˆå¸¦ç¤ºä¾‹æ±‰å­—ï¼‰
- âœ… å­¦ä¹ æ¬¡æ•°ç»Ÿè®¡
- âœ… é¦–æ¬¡è‡ªåŠ¨åˆå§‹åŒ–å­¦ä¹ è®°å½•

**æ•°æ®æµç¨‹**:
1. é¦–æ¬¡è®¿é—® â†’ `POST /api/pinyin-init` åˆå§‹åŒ–
2. ç‚¹å‡»æ‹¼éŸ³ â†’ æœ—è¯»ç¤ºä¾‹æ±‰å­— â†’ `POST /api/pinyin-learn` è®°å½•
3. æ˜¾ç¤ºå­¦ä¹ æ¬¡æ•°ç»Ÿè®¡

---

### 3. **è‹±è¯­æ¨¡å—**

#### 3.1 è‹±è¯­è¯¾æ–‡å­¦ä¹  (`english.html`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… åˆ†çº§å­¦ä¹ ï¼ˆbeginner/intermediate/advancedï¼‰
- âœ… å­¦ä¹ è®°å½•ç»Ÿè®¡
- âš ï¸ åŠŸèƒ½å¼€å‘ä¸­ï¼ˆåŸºç¡€æ¡†æ¶å·²æ­å»ºï¼‰

#### 3.2 è‹±è¯­å•è¯æœ¬ (`vocabulary.html`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… å•è¯å¡ç‰‡å±•ç¤ºï¼ˆè‹±æ–‡ã€éŸ³æ ‡ã€ä¸­æ–‡ï¼‰
- âœ… è‡ªåŠ¨æŸ¥è¯¢å•è¯ä¿¡æ¯ï¼ˆæœ‰é“è¯å…¸ + Dictionary APIï¼‰
- âœ… æ’­æ”¾æ¬¡æ•°ç»Ÿè®¡
- âœ… éŸ³æ ‡æ˜¾ç¤º/éšè—åˆ‡æ¢
- âœ… åˆ é™¤å•è¯ï¼ˆä¿ç•™åˆ é™¤å†å²ï¼‰
- âœ… å•è¯æœ¬ç»Ÿè®¡ï¼ˆä¸è®¤è¯†/å·²è®¤è¯†æ•°é‡ï¼‰

**æ•°æ®æµç¨‹**:
1. æ·»åŠ å•è¯ â†’ `POST /api/english-new-words`
2. è‡ªåŠ¨æŸ¥è¯¢ç¿»è¯‘å’ŒéŸ³æ ‡ï¼ˆ`GET /api/proxy/english/:word`ï¼‰
3. ç‚¹å‡»å¡ç‰‡æœ—è¯» â†’ `POST /api/english-new-words/speak` æ›´æ–°è®¡æ•°
4. åˆ é™¤å•è¯ â†’ `DELETE /api/english-new-words`ï¼ˆç§»è‡³åˆ é™¤è®°å½•è¡¨ï¼‰

---

### 4. **AI è¾…å¯¼æ¨¡å—** (`ai-tutor.html`)

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… å¤šæ¨¡å‹æ”¯æŒï¼ˆGemini Proã€Claude Haikuï¼‰
- âœ… æ–‡æœ¬å¯¹è¯
- âœ… å›¾ç‰‡ä¸Šä¼ ï¼ˆæ”¯æŒæ‹ç…§/ä¸Šä¼ ï¼‰
- âœ… è¯­éŸ³å¯¹è¯ï¼ˆè¿ç»­å¯¹è¯æ¨¡å¼ï¼‰
- âœ… è‡ªåŠ¨æœ—è¯» AI å›å¤
- âœ… å¯¹è¯å†å²ä¿å­˜
- âœ… å•æ¡/å…¨éƒ¨åˆ é™¤å†å²
- âœ… API Key åŠ å¯†å­˜å‚¨ï¼ˆAES-256-GCMï¼‰

**æ ¸å¿ƒåŠŸèƒ½**:
1. **æ–‡æœ¬å¯¹è¯**: ç”¨æˆ·è¾“å…¥é—®é¢˜ â†’ AI å›å¤
2. **å›¾ç‰‡è¯†åˆ«**: ä¸Šä¼ é¢˜ç›®å›¾ç‰‡ â†’ AI è¯†åˆ«å¹¶è§£ç­”
3. **è¯­éŸ³å¯¹è¯**: 
   - å¼€å¯è¯­éŸ³æ¨¡å¼ â†’ è‡ªåŠ¨è¯†åˆ«è¯­éŸ³ â†’ å‘é€ç»™ AI â†’ è‡ªåŠ¨æœ—è¯»å›å¤ â†’ ç»§ç»­ç›‘å¬
   - æ”¯æŒè¿ç»­å¯¹è¯ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
4. **å†å²ç®¡ç†**: æ‰€æœ‰å¯¹è¯è‡ªåŠ¨ä¿å­˜ï¼Œæ”¯æŒåˆ é™¤

**å®‰å…¨æœºåˆ¶**:
- API Key ä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨
- å¯†é’¥æ–‡ä»¶æƒé™é™åˆ¶ï¼ˆ0o600ï¼‰
- æ”¯æŒç¯å¢ƒå˜é‡é…ç½®å¯†é’¥

---

### 5. **æ•°å­¦æ¨¡å—** (`math.html`)

- âš ï¸ å¼€å‘ä¸­ï¼ˆåŸºç¡€æ¡†æ¶å·²æ­å»ºï¼‰

---

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### è¡¨ç»“æ„è¯´æ˜

#### 1. `users` - ç”¨æˆ·è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- username (TEXT UNIQUE) - ç”¨æˆ·å
- password (TEXT) - åŠ å¯†å¯†ç ï¼ˆbcryptï¼‰
- api_key_enc (TEXT) - åŠ å¯†çš„ AI API Key
- created_at (DATETIME) - åˆ›å»ºæ—¶é—´
```

#### 2. `words` - ç”Ÿå­—è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- user_id (INTEGER) - ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰
- hanzi (TEXT) - æ±‰å­—
- pinyin (TEXT) - æ‹¼éŸ³
- speak_count (INTEGER) - æœ—è¯»æ¬¡æ•°
- created_at (DATETIME) - æ·»åŠ æ—¶é—´
- UNIQUE(user_id, hanzi) - æ¯ä¸ªç”¨æˆ·æ¯ä¸ªç”Ÿå­—å”¯ä¸€
```

#### 3. `deleted_words` - ç”Ÿå­—åˆ é™¤è®°å½•è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- user_id (INTEGER) - ç”¨æˆ·ID
- hanzi (TEXT) - æ±‰å­—
- pinyin (TEXT) - æ‹¼éŸ³
- speak_count (INTEGER) - åˆ é™¤æ—¶çš„æœ—è¯»æ¬¡æ•°
- added_at (DATETIME) - åŸæ·»åŠ æ—¶é—´
- deleted_at (DATETIME) - åˆ é™¤æ—¶é—´
```

#### 4. `pinyin_learn` - å£°æ¯éŸµæ¯å­¦ä¹ è®°å½•è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- user_id (INTEGER) - ç”¨æˆ·ID
- pinyin (TEXT) - æ‹¼éŸ³ï¼ˆå£°æ¯æˆ–éŸµæ¯ï¼‰
- type (TEXT) - ç±»å‹ï¼ˆ'initial' æˆ– 'final'ï¼‰
- learn_count (INTEGER) - å­¦ä¹ æ¬¡æ•°
- created_at (DATETIME) - åˆ›å»ºæ—¶é—´
- last_learned_at (DATETIME) - æœ€åå­¦ä¹ æ—¶é—´
- UNIQUE(user_id, pinyin, type)
```

#### 5. `english_learn` - è‹±è¯­å­¦ä¹ è®°å½•è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- user_id (INTEGER) - ç”¨æˆ·ID
- word (TEXT) - å•è¯
- level (TEXT) - éš¾åº¦çº§åˆ«
- learn_count (INTEGER) - å­¦ä¹ æ¬¡æ•°
- created_at (DATETIME) - åˆ›å»ºæ—¶é—´
- last_learned_at (DATETIME) - æœ€åå­¦ä¹ æ—¶é—´
- UNIQUE(user_id, word, level)
```

#### 6. `english_new_words` - è‹±è¯­å•è¯æœ¬è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- user_id (INTEGER) - ç”¨æˆ·ID
- word (TEXT) - å•è¯
- phonetic (TEXT) - éŸ³æ ‡
- chinese (TEXT) - ä¸­æ–‡ç¿»è¯‘
- play_count (INTEGER) - æ’­æ”¾æ¬¡æ•°
- created_at (DATETIME) - æ·»åŠ æ—¶é—´
- UNIQUE(user_id, word)
```

#### 7. `deleted_english_words` - è‹±è¯­å•è¯åˆ é™¤è®°å½•è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- user_id (INTEGER) - ç”¨æˆ·ID
- word (TEXT) - å•è¯
- phonetic (TEXT) - éŸ³æ ‡
- chinese (TEXT) - ä¸­æ–‡ç¿»è¯‘
- play_count (INTEGER) - åˆ é™¤æ—¶çš„æ’­æ”¾æ¬¡æ•°
- added_at (DATETIME) - åŸæ·»åŠ æ—¶é—´
- deleted_at (DATETIME) - åˆ é™¤æ—¶é—´
```

#### 8. `ai_chat_history` - AI å¯¹è¯å†å²è¡¨
```sql
- id (INTEGER PRIMARY KEY)
- user_id (INTEGER) - ç”¨æˆ·ID
- role (TEXT) - è§’è‰²ï¼ˆ'user' æˆ– 'ai'ï¼‰
- content (TEXT) - æ¶ˆæ¯å†…å®¹
- image_data (TEXT) - å›¾ç‰‡æ•°æ®ï¼ˆbase64ï¼‰
- created_at (DATETIME) - åˆ›å»ºæ—¶é—´
```

---

## ğŸ”Œ API æ¥å£æ–‡æ¡£

### ç”¨æˆ·è®¤è¯

#### `POST /api/register` - ç”¨æˆ·æ³¨å†Œ
```json
è¯·æ±‚: { "username": "string", "password": "string" }
å“åº”: { "success": true, "message": "æ³¨å†ŒæˆåŠŸ" }
```

#### `POST /api/login` - ç”¨æˆ·ç™»å½•
```json
è¯·æ±‚: { "username": "string", "password": "string" }
å“åº”: { "success": true, "user_id": number, "username": "string" }
```

#### `POST /api/change-password` - ä¿®æ”¹å¯†ç 
```json
è¯·æ±‚: { "user_id": number, "oldPassword": "string", "newPassword": "string" }
å“åº”: { "success": true }
```

---

### ç”Ÿå­—ç®¡ç†

#### `GET /api/words/:user_id` - è·å–ç”Ÿå­—åˆ—è¡¨
```json
å“åº”: [
  {
    "id": number,
    "hanzi": "å­—",
    "pinyin": "zÃ¬",
    "speak_count": number,
    "created_at": "datetime"
  }
]
```

#### `POST /api/words` - æ·»åŠ ç”Ÿå­—
```json
è¯·æ±‚: { "user_id": number, "hanzi": "å­—" }
å“åº”: { "success": true, "prevDeleted": {...} | null }
```

#### `POST /api/speak` - æ›´æ–°æœ—è¯»æ¬¡æ•°
```json
è¯·æ±‚: { "id": number }
å“åº”: { "success": true }
```

#### `POST /api/delete` - åˆ é™¤ç”Ÿå­—
```json
è¯·æ±‚: { "id": number }
å“åº”: 200 OK
```

#### `GET /api/word-stats/chinese/:user_id` - ç”Ÿå­—ç»Ÿè®¡
```json
å“åº”: { "unknownCount": number, "knownCount": number }
```

---

### æ‹¼éŸ³å­¦ä¹ 

#### `GET /api/pinyin/:user_id` - è·å–å­¦ä¹ è®°å½•
```json
å“åº”: [
  {
    "id": number,
    "pinyin": "b",
    "type": "initial",
    "learn_count": number,
    "last_learned_at": "datetime"
  }
]
```

#### `GET /api/pinyin-list` - è·å–æ‹¼éŸ³åˆ—è¡¨
```json
å“åº”: {
  "initials": ["b", "p", ...],
  "finals": ["a", "o", ...]
}
```

#### `POST /api/pinyin-init` - åˆå§‹åŒ–å­¦ä¹ è®°å½•
```json
è¯·æ±‚: { "user_id": number }
å“åº”: { "success": true }
```

#### `POST /api/pinyin-learn` - æ›´æ–°å­¦ä¹ æ¬¡æ•°
```json
è¯·æ±‚: { "user_id": number, "pinyin": "b", "type": "initial" }
å“åº”: { "success": true }
```

---

### è‹±è¯­å­¦ä¹ 

#### `GET /api/english/:user_id` - è·å–å­¦ä¹ è®°å½•
```json
å“åº”: [
  {
    "id": number,
    "word": "hello",
    "level": "beginner",
    "learn_count": number
  }
]
```

#### `POST /api/english-learn` - æ›´æ–°å­¦ä¹ è®°å½•
```json
è¯·æ±‚: { "user_id": number, "word": "hello", "level": "beginner" }
å“åº”: { "success": true }
```

---

### è‹±è¯­å•è¯æœ¬

#### `GET /api/english-new-words/:user_id` - è·å–å•è¯æœ¬
```json
å“åº”: [
  {
    "id": number,
    "word": "hello",
    "phonetic": "/hÉ™ËˆloÊŠ/",
    "chinese": "ä½ å¥½",
    "play_count": number,
    "created_at": "datetime"
  }
]
```

#### `POST /api/english-new-words` - æ·»åŠ å•è¯
```json
è¯·æ±‚: { "user_id": number, "word": "hello", "phonetic": "...", "chinese": "..." }
å“åº”: { "success": true, "prevDeleted": {...} | null }
```

#### `DELETE /api/english-new-words` - åˆ é™¤å•è¯
```json
è¯·æ±‚: { "user_id": number, "word": "hello" }
å“åº”: { "success": true }
```

#### `POST /api/english-new-words/speak` - æ›´æ–°æ’­æ”¾æ¬¡æ•°
```json
è¯·æ±‚: { "user_id": number, "word": "hello" }
å“åº”: { "success": true }
```

#### `GET /api/word-stats/english/:user_id` - å•è¯æœ¬ç»Ÿè®¡
```json
å“åº”: { "unknownCount": number, "knownCount": number }
```

#### `GET /api/proxy/english/:word` - æŸ¥è¯¢å•è¯ä¿¡æ¯ï¼ˆä»£ç†ï¼‰
```json
å“åº”: { "chinese": "ç¿»è¯‘", "phonetic": "éŸ³æ ‡" }
```

---

### AI è¾…å¯¼

#### `GET /api/ai-key-status/:user_id` - æ£€æŸ¥ API Key é…ç½®
```json
å“åº”: { "configured": boolean }
```

#### `POST /api/ai-key` - ä¿å­˜ API Keyï¼ˆåŠ å¯†ï¼‰
```json
è¯·æ±‚: { "user_id": number, "apiKey": "string" }
å“åº”: { "success": true }
```

#### `POST /api/ai-tutor` - AI å¯¹è¯
```json
è¯·æ±‚: {
  "user_id": number,
  "model": "gemini-3-pro-image-preview",
  "prompt": "é—®é¢˜æ–‡æœ¬",
  "image": "base64å›¾ç‰‡æ•°æ®ï¼ˆå¯é€‰ï¼‰"
}
å“åº”: { "reply": "AIå›å¤å†…å®¹" }
```

#### `GET /api/ai-chat-history/:user_id` - è·å–å¯¹è¯å†å²
```json
å“åº”: [
  {
    "id": number,
    "role": "user" | "ai",
    "content": "æ¶ˆæ¯å†…å®¹",
    "image_data": "base64ï¼ˆå¯é€‰ï¼‰",
    "created_at": "datetime"
  }
]
```

#### `DELETE /api/ai-chat-history/:user_id` - åˆ é™¤å¯¹è¯è®°å½•
```json
è¯·æ±‚: { "id": number } // å¯é€‰ï¼Œä¸ä¼ åˆ™æ¸…ç©ºå…¨éƒ¨
å“åº”: { "success": true }
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### ç”¨æˆ·ç™»å½•æµç¨‹
1. ç”¨æˆ·åœ¨ `index.html` è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
2. è°ƒç”¨ `POST /api/login` æˆ– `POST /api/register`
3. ç™»å½•æˆåŠŸåï¼Œå°†ç”¨æˆ·ä¿¡æ¯ä¿å­˜åˆ° `localStorage`
4. æ˜¾ç¤ºä¸»åº”ç”¨é¡µé¢ï¼ˆå¯¼èˆªæ  + ä¾§è¾¹æ /ç§»åŠ¨ç«¯èœå• + iframe å†…å®¹åŒºï¼‰

### æ¨¡å—åˆ‡æ¢æµç¨‹
1. ç”¨æˆ·ç‚¹å‡»åŠŸèƒ½èœå•ï¼ˆè¯­æ–‡/æ•°å­¦/è‹±è¯­/AIè¾…å¯¼ç­‰ï¼‰
2. `switchPage(page)` å‡½æ•°æ‰§è¡Œ
3. æ›´æ–°å¯¼èˆªæ æ ‡é¢˜å’Œç»Ÿè®¡ä¿¡æ¯
4. ä¿®æ”¹ iframe çš„ `src` å±æ€§åŠ è½½å¯¹åº” HTML æ–‡ä»¶
5. å¯¹åº”çš„ HTML é¡µé¢ç‹¬ç«‹åŠ è½½å’Œæ˜¾ç¤ºå†…å®¹
6. æ ¹æ®é¡µé¢ç±»å‹æ˜¾ç¤º/éšè—æµ®åŠ¨æ·»åŠ æŒ‰é’®

### æ·»åŠ é¡¹ç›®æµç¨‹
1. ç”¨æˆ·ç‚¹å‡»æµ®åŠ¨æŒ‰é’®ï¼ˆâ•ï¼‰
2. `openAddItemModal()` æ ¹æ®å½“å‰é¡µé¢åŠ¨æ€ç”Ÿæˆè¾“å…¥æ¡†
   - ç”Ÿå­—æœ¬ï¼šå•ä¸ªæ±‰å­—è¾“å…¥
   - å•è¯æœ¬ï¼šå•è¯ã€ç¿»è¯‘ã€éŸ³æ ‡è¾“å…¥ï¼ˆæ”¯æŒè‡ªåŠ¨æŸ¥è¯¢ï¼‰
3. ç”¨æˆ·å¡«å†™ä¿¡æ¯å¹¶ä¿å­˜
4. è°ƒç”¨å¯¹åº”çš„ä¿å­˜å‡½æ•°ï¼ˆ`saveChineseItem()` / `saveEnglishItem()`ï¼‰
5. åç«¯ä¿å­˜æˆåŠŸåï¼Œé‡æ–°åŠ è½½ iframe å†…å®¹
6. æ›´æ–°ç»Ÿè®¡ä¿¡æ¯

### è¯­éŸ³åŠŸèƒ½æµç¨‹
1. ç”¨æˆ·åœ¨å‘éŸ³è®¾ç½®ä¸­é€‰æ‹©è¯­é€Ÿå’Œè¯­éŸ³è§’è‰²
2. è®¾ç½®ä¿å­˜åˆ° `localStorage`
3. å„æ¨¡å—è°ƒç”¨ `speak(text, type)` å‡½æ•°
4. ä½¿ç”¨ Web Speech API æœ—è¯»æ–‡æœ¬
5. æ ¹æ®è®¾ç½®åº”ç”¨è¯­é€Ÿå’Œè¯­éŸ³è§’è‰²

---

## ğŸ¨ UI/UX ç‰¹æ€§

### è®¾è®¡é£æ ¼
- **Duolingo é£æ ¼**: åœ†è§’ã€é˜´å½±ã€æ´»æ³¼é…è‰²
- **å“åº”å¼è®¾è®¡**: å®Œç¾é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- **äº¤äº’åé¦ˆ**: æŒ‰é’®ç‚¹å‡»åŠ¨ç”»ã€æ‚¬åœæ•ˆæœ
- **é¢œè‰²ç³»ç»Ÿ**:
  - ä¸»è‰²: `#58cc02` (ç»¿è‰²)
  - æ¬¡è‰²: `#1cb0f6` (è“è‰²)
  - å¼ºè°ƒè‰²: `#ffc800` (é»„è‰²)

### ç§»åŠ¨ç«¯ä¼˜åŒ–
- ä¾§è¾¹æ è‡ªåŠ¨éšè—ï¼Œæ”¹ä¸ºä¸‹æ‹‰èœå•
- è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒï¼ˆä¸‹æ‹‰æ‰“å¼€èœå•ï¼‰
- ç§»åŠ¨ç«¯ä¸“ç”¨å¸ƒå±€å’Œå­—ä½“å¤§å°
- é”®ç›˜å¼¹å‡ºæ—¶è‡ªåŠ¨è°ƒæ•´å¸ƒå±€

### æ¡Œé¢ç«¯ç‰¹æ€§
- å¯æŠ˜å ä¾§è¾¹æ 
- ä¾§è¾¹æ çŠ¶æ€æŒä¹…åŒ–
- åˆ†ç»„å¯¼èˆªï¼ˆè¯­æ–‡ã€è‹±è¯­ã€å·¥å…·ï¼‰

---

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### å¯†ç å®‰å…¨
- ä½¿ç”¨ `bcrypt` åŠ å¯†å­˜å‚¨å¯†ç 
- æ”¯æŒæ—§æ˜æ–‡å¯†ç è‡ªåŠ¨è¿ç§»
- å¯†ç ä¿®æ”¹éœ€è¦éªŒè¯æ—§å¯†ç 

### API Key å®‰å…¨
- ä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨
- å¯†é’¥æ–‡ä»¶æƒé™é™åˆ¶ï¼ˆ0o600ï¼‰
- æ”¯æŒç¯å¢ƒå˜é‡é…ç½®å¯†é’¥
- åŠ å¯†å¯†é’¥è‡ªåŠ¨ç”Ÿæˆï¼ˆ`.ai_key_secret`ï¼‰

### æ•°æ®å®‰å…¨
- SQLite å¤–é”®çº¦æŸå¯ç”¨
- ç”¨æˆ·æ•°æ®éš”ç¦»ï¼ˆåŸºäº user_idï¼‰
- åˆ é™¤æ“ä½œä¿ç•™å†å²è®°å½•

---

## ğŸš€ éƒ¨ç½²è¯´æ˜

### Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰

#### æ„å»ºé•œåƒ
```bash
docker build -t yinianji-1 .
```

#### è¿è¡Œå®¹å™¨
```bash
docker run -d \
  -p 3000:3000 \
  -v $(pwd)/words.db:/app/words.db \
  -e PORT=3000 \
  -e DB_PATH=/app/words.db \
  yinianji-1
```

#### Docker Compose
```bash
docker-compose up -d
```

### ç¯å¢ƒå˜é‡
- `PORT`: æœåŠ¡å™¨ç«¯å£ï¼ˆé»˜è®¤ 3000ï¼‰
- `DB_PATH`: æ•°æ®åº“æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤ `words.db`ï¼‰
- `AI_KEY_SECRET`: AI Key åŠ å¯†å¯†é’¥ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰
- `BCRYPT_ROUNDS`: å¯†ç åŠ å¯†è½®æ•°ï¼ˆé»˜è®¤ 10ï¼‰

### Nginx é…ç½®
é¡¹ç›®åŒ…å« `nginx.conf` å’Œ `nginx-docker.conf` é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒï¼š
- é™æ€æ–‡ä»¶æœåŠ¡
- åå‘ä»£ç†
- HTTPS é…ç½®ï¼ˆéœ€è‡ªè¡Œé…ç½®è¯ä¹¦ï¼‰

---

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æ¨¡å—

1. **åˆ›å»º HTML æ–‡ä»¶**
   - åœ¨ `public/` ç›®å½•åˆ›å»ºæ–°æ¨¡å— HTML
   - ä½¿ç”¨ç»Ÿä¸€çš„æ ·å¼å˜é‡å’Œè®¾è®¡é£æ ¼
   - å®ç°ç‹¬ç«‹çš„åŠ è½½å’Œäº¤äº’é€»è¾‘

2. **åœ¨ `index.html` ä¸­æ³¨å†Œ**
   - åœ¨ä¾§è¾¹æ /ç§»åŠ¨ç«¯èœå•æ·»åŠ å¯¼èˆªé¡¹
   - åœ¨ `switchPage()` å‡½æ•°ä¸­æ·»åŠ è·¯ç”±æ˜ å°„
   - å¦‚éœ€æ·»åŠ åŠŸèƒ½ï¼Œå®ç°å¯¹åº”çš„ä¿å­˜å‡½æ•°

3. **åç«¯ API å¼€å‘**
   - åœ¨ `server.js` ä¸­æ·»åŠ  API ç«¯ç‚¹
   - åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“è¡¨ï¼ˆå¦‚éœ€è¦ï¼‰
   - å®ç°å¢åˆ æ”¹æŸ¥é€»è¾‘

4. **æ•°æ®åº“è¿ç§»**
   - åœ¨ `initDatabase()` å‡½æ•°ä¸­æ·»åŠ è¡¨åˆ›å»ºé€»è¾‘
   - æ”¯æŒæ—§æ•°æ®è¿ç§»ï¼ˆå¦‚éœ€è¦ï¼‰

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ ES6+ è¯­æ³•
- å‡½æ•°å‘½åä½¿ç”¨é©¼å³°å¼
- CSS å˜é‡ç»Ÿä¸€ç®¡ç†
- æ³¨é‡Šæ¸…æ™°ï¼Œè¯´æ˜åŠŸèƒ½æ„å›¾

---

## âœ… é¡¹ç›®ä¼˜åŠ¿

### ä»£ç ç»„ç»‡
- âœ… æ¯ä¸ªæ¨¡å—ç‹¬ç«‹æˆå•ä¸ª HTML æ–‡ä»¶
- âœ… æ˜“äºç»´æŠ¤å’Œè°ƒè¯•
- âœ… å›¢é˜Ÿæˆå‘˜å¯å¹¶è¡Œå¼€å‘ä¸åŒæ¨¡å—
- âœ… æ–‡ä»¶å¤§å°æ§åˆ¶åœ¨åˆç†èŒƒå›´

### èŒè´£åˆ†ç¦»
- âœ… `index.html`: ä¸»æ¡†æ¶å’Œèº«ä»½è®¤è¯
- âœ… å„æ¨¡å— HTML: ç‹¬ç«‹çš„å±•ç¤ºå’Œäº¤äº’
- âœ… `server.js`: ç»Ÿä¸€çš„ API æœåŠ¡
- âœ… æ•°æ®åº“: æ¸…æ™°çš„æ•°æ®ç»“æ„

### æ˜“äºæ‰©å±•
- âœ… æ·»åŠ æ–°æ¨¡å—åªéœ€åˆ›å»ºæ–° HTML æ–‡ä»¶
- âœ… æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
- âœ… æ¨¡å—ä¹‹é—´å®Œå…¨ç‹¬ç«‹
- âœ… API æ¥å£ç»Ÿä¸€è§„èŒƒ

### æ€§èƒ½ä¼˜åŒ–
- âœ… ä½¿ç”¨ iframe å®ç°æ¨¡å—éš”ç¦»
- âœ… æ¯ä¸ªæ¨¡å—æœ‰ç‹¬ç«‹çš„æ ·å¼è¡¨ï¼ˆæ— æ±¡æŸ“ï¼‰
- âœ… ç”¨æˆ·åªåŠ è½½æ‰€éœ€çš„ HTML/CSS
- âœ… é™æ€èµ„æºç¼“å­˜ä¼˜åŒ–

### ç”¨æˆ·ä½“éªŒ
- âœ… å“åº”å¼è®¾è®¡ï¼Œå®Œç¾é€‚é…å„ç§è®¾å¤‡
- âœ… æµç•…çš„åŠ¨ç”»å’Œäº¤äº’åé¦ˆ
- âœ… è¯­éŸ³åŠŸèƒ½å¢å¼ºå­¦ä¹ ä½“éªŒ
- âœ… AI è¾…å¯¼æä¾›ä¸ªæ€§åŒ–å¸®åŠ©

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `DEPLOY.md` - è¯¦ç»†éƒ¨ç½²æŒ‡å—
- `README-DEV.md` - å¼€å‘ç¯å¢ƒé…ç½®
- `server-deploy-guide.md` - æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

---

## ğŸ”® æœªæ¥è§„åˆ’

- [ ] æ•°å­¦æ¨¡å—å®Œæ•´å¼€å‘
- [ ] è‹±è¯­è¯¾æ–‡æ¨¡å—å®Œå–„
- [ ] å­¦ä¹ è¿›åº¦å¯è§†åŒ–
- [ ] å­¦ä¹ æŠ¥å‘Šç”Ÿæˆ
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] ç¦»çº¿åŠŸèƒ½æ”¯æŒ
- [ ] æ•°æ®å¯¼å‡º/å¯¼å…¥

---

**æœ€åæ›´æ–°**: 2024å¹´
